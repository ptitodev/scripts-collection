<html><head><title>Move-VM - PowerCLI System.Collections.Hashtable.ModuleName Help Reference</title><meta name="description" content=" Move-VM" /><meta name="keywords" content="PowerCLI System.Collections.Hashtable.ModuleName Help Reference, Move-VM, Move, VM" /><link href="doc-style.css" type="text/css" rel="StyleSheet"></head><body><h2 class="title"><a class="title" href='index.html' target="_top">PowerCLI Reference</a></h2><h1>Move-VM</h1><h2>Synopsis</h2>This cmdlet moves virtual machines to another location.<p class="table-title">Syntax</p>Move-VM [-AdvancedOption &lt;AdvancedOption[]&gt;] [[-Destination] &lt;VIContainer&gt;] [-Datastore &lt;StorageResource&gt;] [-DiskStorageFormat &lt;VirtualDiskStorageFormat&gt;] [-VMotionPriority &lt;VMotionPriority&gt;] [-NetworkAdapter &lt;NetworkAdapter[]&gt;] [-PortGroup &lt;VirtualPortGroupBase[]&gt;] [-InventoryLocation &lt;FolderContainer&gt;] [-RunAsync] [-VM] &lt;VirtualMachine[]&gt; [-Server &lt;VIServer[]&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]<p class="table-title">Related Commands</p><a href='https://vdc-repo.vmware.com/vmwb-repository/dcr-public/7837e367-fe26-4d85-bd03-84d88261642c/2bc2f4e0-41f5-48b1-929e-e1568a8fe070/doc/Move-VM.html'>Online version</a><br><a href='Get-VM.html'>Get-VM</a><br><a href='Remove-VM.html'>Remove-VM</a><br><a href='New-VM.html'>New-VM</a><br><a href='Set-VM.html'>Set-VM</a><br><a href='Start-VM.html'>Start-VM</a><br><a href='Stop-VM.html'>Stop-VM</a><br><a href='Suspend-VM.html'>Suspend-VM</a><br><a href='Restart-VM.html'>Restart-VM</a><br><p class="table-title">Detailed Description</p>This cmdlet moves a virtual machine to the location that is specified by the Destination or the Datastore parameters. The destination must be a folder, host, cluster, or a resource pool. You can move a virtual machine to a DRS cluster. Moving a virtual machine to the top level of a non-DRS cluster is only possible if the virtual machine is in a resource pool in that cluster. If the virtual machine is outside the non-DRS cluster, you need to specify a virtual machine host in that cluster as destination. When moving virtual machines that are powered on, vMotion is used. You can move storage and compute resources simultaneously. You can move virtual machines between vCenter Server systems of vSphere version 6.0 and later. To specify a server different from the default one, use the Server parameter. When you move a virtual machine from one vCenter Server system to another, only hosts are supported as compute destinations and only datastores are supported as storage destinations.<p class="table-title">Parameters</p><table cellspacing="0"><tr><th>Name</th><th>Type</th><th>Description</th><th>Required?</td><th>Pipeline Input</th><th>Default Value</th></tr><tr class="r1"><td><a id="VM" name="VM"></a><strong>VM</strong></td><td><a href="VirtualMachine.html">VirtualMachine</a>[]</td><td>Specifies the virtual machines you want to move to another location.</td><td>true</td><td>true (ByValue)</td><tr class="r0"><td><a id="Destination" name="Destination"></a><strong>Destination</strong></td><td><a href="VIContainer.html">VIContainer</a></td><td>Specifies a folder, host, cluster, or a resource pool where you want to move the virtual machines. If a datacenter is specified for the Destination parameter, the virtual machines are moved to the datacenter&#39;s &quot;vmFolder&quot; folder. The &quot;vmFolder&quot; is a system folder and is guaranteed to exist.
<br/>Passing values to this parameter through a pipeline is deprecated and will be disabled in a future release.</td><td>false</td><td>true (ByValue)</td><tr class="r1"><td><a id="AdvancedOption" name="AdvancedOption"></a><strong>AdvancedOption</strong></td><td><a href="AdvancedOption.html">AdvancedOption</a>[]</td><td>This parameter is only applicable when a DatastoreCluster object is passed to the Datastore parameter.
<br/>Specifies one or more rules for the placement of the virtual machines that you want to relocate. 
<br/>
<br/>To indicate that VMs should be stored on different datastores, pass an SdrsVMAntiAffinityRule object to the parameter. You can set more than one Storage DRS (SDRS) VM anti-affinity rules.
<br/>
<br/>To indicate that the VM disks should be stored on different datastores, pass an SdrsVMDiskAntiAffinityRule object to the parameter. You can set only one SDRS VM disk anti-affinity rule.</td><td>false</td><td>false</td><tr class="r0"><td><a id="Confirm" name="Confirm"></a><strong>Confirm</strong></td><td>SwitchParameter</td><td>If the value is $true, indicates that the cmdlet asks for confirmation before running. If the value is $false, the cmdlet runs without asking for user confirmation.</td><td>false</td><td>false</td><tr class="r1"><td><a id="Datastore" name="Datastore"></a><strong>Datastore</strong></td><td><a href="StorageResource.html">StorageResource</a></td><td>Specifies the datastore or datastore cluster where you want to move the virtual machines. When you pass a datastore cluster to the Datastore parameter, you can also set the AdvancedOption parameter.</td><td>false</td><td>false</td><tr class="r0"><td><a id="DiskStorageFormat" name="DiskStorageFormat"></a><strong>DiskStorageFormat</strong></td><td><a href="VirtualDiskStorageFormat.html">VirtualDiskStorageFormat</a></td><td>Specifies a new storage format for the hard disk of the virtual machine you want to move. This parameter is applicable only when moving a virtual machine to a different datastore, using the Datastore parameter. This parameter accepts Thin, Thick, and EagerZeroedThick values.</td><td>false</td><td>false</td><tr class="r1"><td><a id="InventoryLocation" name="InventoryLocation"></a><strong>InventoryLocation</strong></td><td><a href="FolderContainer.html">FolderContainer</a></td><td>Specifies a datacenter or a virtual machine folder where you want to move the virtual machine.</td><td>false</td><td>false</td><tr class="r0"><td><a id="NetworkAdapter" name="NetworkAdapter"></a><strong>NetworkAdapter</strong></td><td><a href="NetworkAdapter.html">NetworkAdapter</a>[]</td><td>Specifies the virtual machine network adapters you want to migrate to a new port group.</td><td>false</td><td>false</td><tr class="r1"><td><a id="PortGroup" name="PortGroup"></a><strong>PortGroup</strong></td><td><a href="VirtualPortGroupBase.html">VirtualPortGroupBase</a>[]</td><td>Specifies the destination port groups for the specified virtual machine network adapters. The number of port groups should be one, or equal to the number of network adapters specified. If one port group and more than one network adapters are specified, all network adapters are migrated to the specified port group.</td><td>false</td><td>false</td><tr class="r0"><td><a id="RunAsync" name="RunAsync"></a><strong>RunAsync</strong></td><td>SwitchParameter</td><td>Indicates that the command returns immediately without waiting for the task to complete. In this mode, the output of the cmdlet is a Task object. For more information about the RunAsync parameter run &quot;help About_RunAsync&quot; in the VMware PowerCLI console.</td><td>false</td><td>false</td><tr class="r1"><td><a id="Server" name="Server"></a><strong>Server</strong></td><td><a href="VIServer.html">VIServer</a>[]</td><td>Specifies the vCenter Server systems on which you want to run the cmdlet. If no value is passed to this parameter, the command runs on the default servers. For more information about default servers, see the description of Connect-VIServer.</td><td>false</td><td>false</td><tr class="r0"><td><a id="VMotionPriority" name="VMotionPriority"></a><strong>VMotionPriority</strong></td><td><a href="VMotionPriority.html">VMotionPriority</a></td><td>Determines the priority that should be used for a vMotion operation.</td><td>false</td><td>false</td><tr class="r1"><td><a id="WhatIf" name="WhatIf"></a><strong>WhatIf</strong></td><td>SwitchParameter</td><td>Indicates that the cmdlet is run only to display the changes that would be made and actually no objects are modified.</td><td>false</td><td>false</td></table><p class="table-title">Return Type</p>Zero or more relocated <a href="VirtualMachine.html">VirtualMachine</a> objects
<p class="table-title">Notes</p><p class="table-title">Examples</p><div class="example"><p class="example-title">--------------  Example 1 --------------</p><pre class="programlisting">Get-VM -Name VM | Move-VM -Destination 10.23.112.235</pre><p>Moves the virtual machine named VM from its current location to the host on IP address 10.23.112.235.</p><p class="example-title">--------------  Example 2 --------------</p><pre class="programlisting">Move-VM -VM VM -Destination Folder</pre><p>Moves the virtual machine to a folder called Folder. Note that you are able to move virtual machines only to folders containing virtual machines (the &#39;blue&#39; folders in the vSphere Client).</p><p class="example-title">--------------  Example 3 --------------</p><pre class="programlisting">Move-VM -VM &#39;MyVM&#39; -Destination &#39;MyDestination&#39;</pre><p>Moves a powered-on virtual machine from one existing host to another, by using vMotion, passing parameters by name.</p><p class="example-title">--------------  Example 4 --------------</p><pre class="programlisting">Move-VM -VM &#39;MyVM&#39; -Datastore &#39;MyDatastore&#39;</pre><p>Moves a powered-on virtual machine from one existing datastore to another, by using storage vMotion, passing parameters by name.</p><p class="example-title">--------------  Example 5 --------------</p><pre class="programlisting">$myDatastoreCluster1 = Get-DatastoreCluster -Name &#39;MyDatastoreCluster1&#39;
Move-VM -VM &#39;MyVM1&#39; -Datastore $myDatastoreCluster1</pre><p>Moves the MyVM1 virtual machine to any datastore in the specified datastore cluster.</p><p class="example-title">--------------  Example 6 --------------</p><pre class="programlisting">$myDatastoreCluster1 = Get-DatastoreCluster -Name &#39;MyDatastoreCluster1&#39;
$myVm2 = Get-VM -Name &#39;MyVM2&#39;
$vmAntiAffinityRule = New-Object -TypeName VMware.VimAutomation.ViCore.Types.V1.DatastoreManagement.SdrsVMAntiAffinityRule -ArgumentList $myVm2
Move-VM -VM &#39;MyVM1&#39; -Datastore $myDatastoreCluster1 -AdvancedOption $vmAntiAffinityRule</pre><p>Moves the MyVM1 virtual machine to the specified datastore cluster and sets a VM anti-affinity rule for the placement of the virtual machine. The MyVM1 virtual machine will be placed on any datastore in the specified datastore cluster that does not contain the MyVM2 virtual machine.</p><p class="example-title">--------------  Example 7 --------------</p><pre class="programlisting">$myVm1 = Get-VM -Name &#39;MyVM1&#39;
$vmdks = Get-Harddisk -VM $myVm1
$myDatastoreCluster1 = Get-DatastoreCluster -Name &#39;MyDatastoreCluster1&#39;
$vmdkAntiAffinityRule = New-Object -TypeName VMware.VimAutomation.ViCore.Types.V1.DatastoreManagement.SdrsVMDiskAntiAffinityRule -ArgumentList $vmdks
Move-VM -VM &#39;$myVm1&#39; -Datastore $myDatastoreCluster1 -AdvancedOption $vmdkAntiAffinityRule</pre><p>Moves the MyVM1 virtual machine to the specified datastore cluster and sets a VM disk anti-affinity rule for the placement of the virtual machine. The disks of the MyVM1 virtual machine will be stored on different datastores in the specified datastore cluster.</p><p class="example-title">--------------  Example 8 --------------</p><pre class="programlisting">Get-VM -Name &#39;MyVM&#39; -Server &#39;MyServer&#39; | Move-VM -Destination &#39;NewHost&#39; -Datastore &#39;DatastoreOnNewHost&#39; -DiskStorageFormat &#39;Thin&#39;</pre><p>Moves a powered-off virtual machine to another datastore on another host and changes its disk storage format to thin.</p><p class="example-title">--------------  Example 9 --------------</p><pre class="programlisting">Connect-VIServer &#39;myVC1&#39; -Username &lt;username&gt; -Password &lt;pass&gt;
Connect-VIServer &#39;myVC2&#39; -Username &lt;username&gt; -Password &lt;pass&gt;

$vm = Get-VM &#39;myVM&#39; -Location &#39;myVMhostOnVC1&#39;
$destination = Get-VMHost &#39;MyVMhostOnVc2&#39;
$networkAdapter = Get-NetworkAdapter -VM $vm
$destinationPortGroup = Get-VDPortgroup -VDSwitch &#39;myVDSwitchOnVC2&#39; -Name &#39;myPortGroup&#39;
$destinationDatastore = Get-Datastore &#39;MyDatastoreOnVc2&#39;

$vm | Move-VM -Destination $destination -NetworkAdapter $networkAdapter -PortGroup $destinationPortGroup -Datastore $destinationDatastore</pre><p>Moves the MyVM virtual machine from one vCenter Server system to another. Specifies myPortGroup as the destination port group and MyDatastoreOnVc2 as the destination datastore.
<br/>
<br/>Note: This functionality works only against vSphere 6.0 and later environments.</p></div><hr>Copyright &copy; VMware, Inc.&nbsp;All rights reserved.</body></html>
