<html><head><title>New-VIProperty - PowerCLI System.Collections.Hashtable.ModuleName Help Reference</title><meta name="description" content=" New-VIProperty" /><meta name="keywords" content="PowerCLI System.Collections.Hashtable.ModuleName Help Reference, New-VIProperty, New, VIProperty" /><link href="doc-style.css" type="text/css" rel="StyleSheet"></head><body><h2 class="title"><a class="title" href='index.html' target="_top">PowerCLI Reference</a></h2><h1>New-VIProperty</h1><h2>Synopsis</h2>This cmdlet creates a new extension property on the specified object type.<p class="table-title">Syntax</p>New-VIProperty [-Name] &lt;String&gt; [-ObjectType] &lt;String[]&gt; [-Value] &lt;ScriptBlock&gt; [-Force] [-BasedOnExtensionProperty &lt;String[]&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]
<br/>
<br/>New-VIProperty [-Name] &lt;String&gt; [-ObjectType] &lt;String[]&gt; [-Force] [-ValueFromExtensionProperty] &lt;String&gt; [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]<p class="table-title">Related Commands</p><a href='https://vdc-repo.vmware.com/vmwb-repository/dcr-public/7837e367-fe26-4d85-bd03-84d88261642c/2bc2f4e0-41f5-48b1-929e-e1568a8fe070/doc/New-VIProperty.html'>Online version</a><br><a href='Get-VIProperty.html'>Get-VIProperty</a><br><a href='Remove-VIProperty.html'>Remove-VIProperty</a><br><p class="table-title">Detailed Description</p>This cmdlet creates a new extension property on the specified object type. Changes take effect upon the next retrieval of the corresponding objects.<p class="table-title">Parameters</p><table cellspacing="0"><tr><th>Name</th><th>Type</th><th>Description</th><th>Required?</td><th>Pipeline Input</th><th>Default Value</th></tr><tr class="r1"><td><a id="Name" name="Name"></a><strong>Name</strong></td><td>String</td><td>Specifies a name for the new extension property. Names are case-sensitive and can include only letters, numbers, and the underscore symbol. The name of a property must start with a letter or underscore.</td><td>true</td><td>false</td><tr class="r0"><td><a id="ObjectType" name="ObjectType"></a><strong>ObjectType</strong></td><td>String[]</td><td>Specifies the object types to which you want to append the new property. All PowerCLI object types are supported.</td><td>true</td><td>false</td><tr class="r1"><td><a id="Value" name="Value"></a><strong>Value</strong></td><td>ScriptBlock</td><td>Specifies a script block you want to use to compute the value of the new extended property.</td><td>true</td><td>false</td><tr class="r0"><td><a id="ValueFromExtensionProperty" name="ValueFromExtensionProperty"></a><strong>ValueFromExtensionProperty</strong></td><td>String</td><td>Specifies a string that maps a property of the $this.ExtensionData object. This parameter is case-sensitive.</td><td>true</td><td>false</td><tr class="r1"><td><a id="BasedOnExtensionProperty" name="BasedOnExtensionProperty"></a><strong>BasedOnExtensionProperty</strong></td><td>String[]</td><td>Specifies a list of strings that maps the properties of the $this.ExtensionData object. Use this parameter to specify which members of ExtensionData are used by the script block provided for the Value parameter.
<br/>This parameter is case-sensitive.</td><td>false</td><td>false</td><tr class="r0"><td><a id="Confirm" name="Confirm"></a><strong>Confirm</strong></td><td>SwitchParameter</td><td>If the value is $true, indicates that the cmdlet asks for confirmation before running. If the value is $false, the cmdlet runs without asking for user confirmation.</td><td>false</td><td>false</td><tr class="r1"><td><a id="Force" name="Force"></a><strong>Force</strong></td><td>SwitchParameter</td><td>Indicates that you want to create the new property even if another property with the same name exists for the specified object type. This parameter is not applicable for core properties of an object type.</td><td>false</td><td>false</td><tr class="r0"><td><a id="WhatIf" name="WhatIf"></a><strong>WhatIf</strong></td><td>SwitchParameter</td><td>Indicates that the cmdlet is run only to display the changes that would be made and actually no objects are modified.</td><td>false</td><td>false</td></table><p class="table-title">Return Type</p>The newly created <a href="VIProperty.html">VIProperty</a> object
<p class="table-title">Notes</p>In PowerShell 2.0, errors in evaluating values of new properties are not displayed. You can find information about 
    these errors in the $Error environment variable.<p class="table-title">Examples</p><div class="example"><p class="example-title">--------------  Example 1 --------------</p><pre class="programlisting">New-VIProperty -ObjectType VirtualMachine -Name CommittedSpaceMB -Value { $vm = $args[0]; $sum = 0; $vm.ExtensionData.Storage.PerDatastoreUsage | foreach { $sum += $_.Committed} ; $sum = [int]($sum / 1024 / 1024); return $sum }

Get-VM | select Name, CommittedSpaceMB</pre><p>Creates a script-based property for the VirtualMachine object type that calculates the committed space of a virtual machine.</p><p class="example-title">--------------  Example 2 --------------</p><pre class="programlisting">New-VIProperty -ObjectType VirtualMachine -Name CommittedSpaceMB -Value { $vm = $args[0]; $sum = 0; $vm.ExtensionData.Storage.PerDatastoreUsage | foreach { $sum += $_.Committed} ; $sum = [int]($sum / 1024 / 1024); return $sum } -BasedOnExtensionProperty &#39;Storage.PerDatastoreUsage.Committed&#39; -Force

Get-VM | select Name, CommittedSpaceMB</pre><p>Creates a property that calculates the committed space of a virtual machine. The cmdlet uses the BasedOnExtensionProperty parameter to specify which   ExtensionData member is used by the script block. This mean that during the creation of each virtual machine, only the specified property of extension data - Storage.PerDatastoreUsage.Committed will be filled up.</p><p class="example-title">--------------  Example 3 --------------</p><pre class="programlisting">New-VIProperty -ObjectType VirtualMachine -Name CommittedSpace -ValueFromExtensionProperty &#39;SUM Storage.PerDatastoreUsage.Committed&#39;</pre><p>Creates a new property that calculates the committed storage based on the property and aggregation function SUM specified by the ValueFromExtensionProperty parameter.</p><p class="example-title">--------------  Example 4 --------------</p><pre class="programlisting">New-VIProperty -ObjectType InventoryItem -Name OverallStatus -ValueFromExtensionProperty &#39;OverallStatus&#39;

Get-VM | select Name, OverallStatus

Get-VMHost | select Name, OverallStatus</pre><p>Creates a new property based on the OverallStatus property for all inventory types.</p><p class="example-title">--------------  Example 5 --------------</p><pre class="programlisting">New-VIProperty -ObjectType VIObjectCore -Value { if ( $args[0].UId -match &quot;/VIserver=[\w]+@(.*):.*&quot; ) { $matches[1] } else { &quot; } } -Name VIServerName

Get-Inventory | select Name, VIServerName</pre><p>Creates a script-based property to VIObjectCore that parses the UId property and extracts the name of the server to which a given object belongs.</p></div><hr>Copyright &copy; VMware, Inc.&nbsp;All rights reserved.</body></html>
