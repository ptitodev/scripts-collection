<html><head><title>Invoke-VMScript - PowerCLI System.Collections.Hashtable.ModuleName Help Reference</title><meta name="description" content=" Invoke-VMScript" /><meta name="keywords" content="PowerCLI System.Collections.Hashtable.ModuleName Help Reference, Invoke-VMScript, Invoke, VMScript" /><link href="doc-style.css" type="text/css" rel="StyleSheet"></head><body><h2 class="title"><a class="title" href='index.html' target="_top">PowerCLI Reference</a></h2><h1>Invoke-VMScript</h1><h2>Synopsis</h2>This cmdlet runs a script in the guest OS of each of the specified virtual machines.<p class="table-title">Syntax</p>Invoke-VMScript [-ScriptText] &lt;String&gt; [-VM] &lt;VirtualMachine[]&gt; [-HostCredential &lt;PSCredential&gt;] [-HostUser &lt;String&gt;] [-HostPassword &lt;SecureString&gt;] [-GuestCredential &lt;PSCredential&gt;] [-GuestUser &lt;String&gt;] [-GuestPassword &lt;SecureString&gt;] [-ToolsWaitSecs &lt;Int32&gt;] [-ScriptType &lt;ScriptType&gt;] [-RunAsync] [-Server &lt;VIServer[]&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]<p class="table-title">Related Commands</p><a href='https://vdc-repo.vmware.com/vmwb-repository/dcr-public/7837e367-fe26-4d85-bd03-84d88261642c/2bc2f4e0-41f5-48b1-929e-e1568a8fe070/doc/Invoke-VMScript.html'>Online version</a><br><p class="table-title">Detailed Description</p>This cmdlet runs a script in the guest OS of each of the specified virtual machines. To run Invoke-VMScript, the user must have read access to the folder containing the virtual machine and a Virtual Machine.Interaction.Console Interaction privilege. The virtual machines must be powered on and have VMware Tools installed. Network connectivity to the ESX system hosting the virtual machine on port 902 must be present. To authenticate with the host or the guest OS, one of the HostUser/HostPassword (GuestUser/GuestPassword) pair and HostCredential (GuestCredential) parameters must be provided. The guest account you use to authenticate with the guest operating system must have administrator&#39;s privileges. For a list of supported operating systems, see the PowerCLI User&#39;s Guide.
<br/>
<br/>To run this cmdlet against vCenter Server/ESX/ESXi versions earlier than 5.0, you need to meet the following requirements:
<br/>*You must run the cmdlet on the 32-bit version of Windows PowerShell.
<br/>*You must have access to the ESX that hosts the virtual machine over TCP port 902.
<br/>*For vCenter Server/ESX/ESXi versions earlier than 4.1, you need VirtualMachine.Interact.ConsoleInteract privilege. For vCenter Server/ESX/ESXi 4.1 and later, you need VirtualMachine.Interact.GuestControl privilege.
<br/>
<br/>To run this cmdlet against vCenter Server/ESXi 5.0 and later, you need VirtualMachine.GuestOperations.Modify and VirtualMachine.GuestOperations.Execute privileges.<p class="table-title">Parameters</p><table cellspacing="0"><tr><th>Name</th><th>Type</th><th>Description</th><th>Required?</td><th>Pipeline Input</th><th>Default Value</th></tr><tr class="r1"><td><a id="ScriptText" name="ScriptText"></a><strong>ScriptText</strong></td><td>String</td><td>Provides the text of the script you want to run. You can also pass to this parameter a string variable containing the path to the script.</td><td>true</td><td>false</td><tr class="r0"><td><a id="VM" name="VM"></a><strong>VM</strong></td><td><a href="VirtualMachine.html">VirtualMachine</a>[]</td><td>Specifies the virtual machines on whose guest operating systems you want to run the script.</td><td>true</td><td>true (ByValue)</td><tr class="r1"><td><a id="Confirm" name="Confirm"></a><strong>Confirm</strong></td><td>SwitchParameter</td><td>If the value is $true, indicates that the cmdlet asks for confirmation before running. If the value is $false, the cmdlet runs without asking for user confirmation.</td><td>false</td><td>false</td><tr class="r0"><td><a id="GuestCredential" name="GuestCredential"></a><strong>GuestCredential</strong></td><td>PSCredential</td><td>Specifies a PSCredential object containing the credentials you want to use for authenticating with the virtual machine guest OS.</td><td>false</td><td>false</td><tr class="r1"><td><a id="GuestPassword" name="GuestPassword"></a><strong>GuestPassword</strong></td><td>SecureString</td><td>Specifies the password you want to use for authenticating with the virtual machine guest OS.</td><td>false</td><td>false</td><tr class="r0"><td><a id="GuestUser" name="GuestUser"></a><strong>GuestUser</strong></td><td>String</td><td>Specifies the user name you want to use for authenticating with the virtual machine guest OS.</td><td>false</td><td>false</td><tr class="r1"><td><a id="HostCredential" name="HostCredential"></a><strong>HostCredential</strong></td><td>PSCredential</td><td>Specifies a PSCredential object containing the credentials you want to use for authenticating with the host. You need to specify host credentials only if the version of the vCenter Server or ESX you are authenticating with is earlier than 4.0, or the VIX version you have installed is earlier than 1.10.</td><td>false</td><td>false</td><tr class="r0"><td><a id="HostPassword" name="HostPassword"></a><strong>HostPassword</strong></td><td>SecureString</td><td>Specifies the password you want to use for authenticating with the host. You need to specify host credentials only if the version of the vCenter Server or ESX you are authenticating with is earlier than 4.0, or the VIX version you have installed is earlier than 1.10.</td><td>false</td><td>false</td><tr class="r1"><td><a id="HostUser" name="HostUser"></a><strong>HostUser</strong></td><td>String</td><td>Specifies the user name you want to use for authenticating with the host. You need to specify host credentials only if the version of the vCenter Server or ESX you are authenticating with is earlier than 4.0, or the VIX version you have installed is earlier than 1.10.</td><td>false</td><td>false</td><tr class="r0"><td><a id="RunAsync" name="RunAsync"></a><strong>RunAsync</strong></td><td>SwitchParameter</td><td>Indicates that the command returns immediately without waiting for the task to complete. In this mode, the output of the cmdlet is a Task object. For more information about the RunAsync parameter run &quot;help About_RunAsync&quot; in the VMware PowerCLI console.</td><td>false</td><td>false</td><tr class="r1"><td><a id="ScriptType" name="ScriptType"></a><strong>ScriptType</strong></td><td><a href="ScriptType.html">ScriptType</a></td><td>Specifies the type of the script. The valid values are PowerShell, Bat, and Bash. If the virtual machine OS is Windows, the default value is PowerShell. If the virtual machine OS is Linux, the default value is Bash.</td><td>false</td><td>false</td><tr class="r0"><td><a id="Server" name="Server"></a><strong>Server</strong></td><td><a href="VIServer.html">VIServer</a>[]</td><td>Specifies the vCenter Server systems on which you want to run the cmdlet. If no value is passed to this parameter, the command runs on the default servers. For more information about default servers, see the description of Connect-VIServer.</td><td>false</td><td>false</td><tr class="r1"><td><a id="ToolsWaitSecs" name="ToolsWaitSecs"></a><strong>ToolsWaitSecs</strong></td><td>Int32</td><td>Specifies how long in seconds the system waits for connecting to the VMware Tools. The default value is 20.</td><td>false</td><td>false</td><tr class="r0"><td><a id="WhatIf" name="WhatIf"></a><strong>WhatIf</strong></td><td>SwitchParameter</td><td>Indicates that the cmdlet is run only to display the changes that would be made and actually no objects are modified.</td><td>false</td><td>false</td></table><p class="table-title">Return Type</p>One or more <a href="VMScriptResult.html">VMScriptResult</a> objectsVMScriptResult
<p class="table-title">Notes</p>To make PowerShell scripts work, you must restart the virtual machine after the PowerShell installation. For BIN 
    and BASH scripts, restart is not needed.<p class="table-title">Examples</p><div class="example"><p class="example-title">--------------  Example 1 --------------</p><pre class="programlisting">Invoke-VMScript -VM VM -ScriptText &quot;dir&quot; -GuestUser administrator -GuestPassword pass2</pre><p>Lists the directory entries on the guest OS.</p><p class="example-title">--------------  Example 2 --------------</p><pre class="programlisting">$script = &#39;&amp;&quot;$env:ProgramFiles\Common Files\Microsoft Shared\MSInfo\msinfo32.exe&quot; /report &quot;$env:Tmp\inforeport&quot;&#39;

Invoke-VMScript -ScriptText $script -VM VM -GuestCredential $guestCredential</pre><p>Runs a PowerShell script. In PowerShell, to access environment variables, you must use the following syntax: $env:&lt;environment variable&gt; (for example, $env:ProgramFiles). Also, to run the program, you must specify an ampersand (&amp;) in front of the program path.
<br/>The outer quotes ($script = &#39;...&#39;) are required because this is how you define a string variable in PowerShell. The inner double quotes are required because there are spaces in the path.</p><p class="example-title">--------------  Example 3 --------------</p><pre class="programlisting">$script = &#39;&quot;%programfiles%\Common Files\Microsoft Shared\MSInfo\msinfo32.exe&quot; /report &quot;%tmp%\inforeport&quot;&#39;

Invoke-VMScript -ScriptText $script -VM VM -GuestCredential $guestCredential -ScriptType Bat</pre><p>Runs a BAT script. In BAT scripts, to access environment variables, you must use the following syntax: %&lt;environment variable&gt;% (for example, %programfiles%).
<br/>
<br/>The outer quotes ($script = &#39;...&#39;) are required because this is how you define a string variable in PowerShell. The inner double quotes are required because there are spaces in the path.</p></div><hr>Copyright &copy; VMware, Inc.&nbsp;All rights reserved.</body></html>
