<html><head><title>Connect-OMServer - PowerCLI System.Collections.Hashtable.ModuleName Help Reference</title><meta name="description" content=" Connect-OMServer" /><meta name="keywords" content="PowerCLI System.Collections.Hashtable.ModuleName Help Reference, Connect-OMServer, Connect, OMServer" /><link href="doc-style.css" type="text/css" rel="StyleSheet"></head><body><h2 class="title"><a class="title" href='index.html' target="_top">PowerCLI Reference</a></h2><h1>Connect-OMServer</h1><h2>Synopsis</h2>This cmdlet establishes a connection to the specified vRealize Operations Manager server.<p class="table-title">Syntax</p>Connect-OMServer [-Server] &lt;String[]&gt; [-User &lt;String&gt;] [-Password &lt;SecureString&gt;] [-AuthSource &lt;String&gt;] [-Port &lt;Int32&gt;] [-NotDefault] [-Force] [-SaveCredentials] [-InformationAction &lt;ActionPreference&gt;] [-InformationVariable &lt;String&gt;] [-PipelineVariable &lt;String&gt;] [&lt;CommonParameters&gt;]
<br/>
<br/>Connect-OMServer [-Server] &lt;String[]&gt; [-Port &lt;Int32&gt;] [-NotDefault] [-Force] -SessionSecret &lt;String&gt; [-InformationAction &lt;ActionPreference&gt;] [-InformationVariable &lt;String&gt;] [-PipelineVariable &lt;String&gt;] [&lt;CommonParameters&gt;]
<br/>
<br/>Connect-OMServer [-Server] &lt;String[]&gt; [-AuthSource &lt;String&gt;] [-Port &lt;Int32&gt;] -Credential &lt;PSCredential&gt; [-NotDefault] [-Force] [-SaveCredentials] [-InformationAction &lt;ActionPreference&gt;] [-InformationVariable &lt;String&gt;] [-PipelineVariable &lt;String&gt;] [&lt;CommonParameters&gt;]
<br/>
<br/>Connect-OMServer -Menu [-InformationAction &lt;ActionPreference&gt;] [-InformationVariable &lt;String&gt;] [-PipelineVariable &lt;String&gt;] [&lt;CommonParameters&gt;]<p class="table-title">Related Commands</p><a href='http://www.vmware.com/support/developer/PowerCLI/PowerCLI651/html/Connect-OMServer.html'>Online version</a><br><a href='Disconnect-OMServer.html'>Disconnect-OMServer</a><br><p class="table-title">Detailed Description</p>This cmdlet establishes a connection to the vRealize Operations Manager server specified by the -Server parameter.
<br/>
<br/>The connect and disconnect operations for a server are using a reference counting mechanism. Every server is identified by its connection string which contains server, user name, and authentication source. If there is already an existing connection to the server, a new connection is not established. Instead, the cmdlet returns the object which represents the existing connection. The RefCount property of the object is incremented by one. Note that a new object is not created. Therefore, the RefCount of the previously returned object will be updated as well. When a server is disconnected, then its RefCount property is decreased by one. If this number becomes equal to zero, then the server is disconnected.
<br/>
<br/>PowerCLI supports a list of default vRealize Operations Manager servers. When an operation is performed, if the target servers cannot be determined from the specified parameters, the cmdlet runs against the servers in the default server list. They are kept in a global variable called $DefaultOMServers. It is of an array type and its initial value is an empty array. When you connect to a server, the server is added at the beginning of the array, unless -NotDefault parameter is specified. When you disconnect from a server, the server is removed from the $DefaultOMServers variable. When all servers are removed from the variable, its value is an empty array. You can modify the value of the $DefaultOMServers variable manually.<p class="table-title">Parameters</p><table cellspacing="0"><tr><th>Name</th><th>Type</th><th>Description</th><th>Required?</td><th>Pipeline Input</th><th>Default Value</th></tr><tr class="r1"><td><a id="Server" name="Server"></a><strong>Server</strong></td><td>String[]</td><td>Specifies the IP or DNS addresses of the vRealize Operations Manager servers you want to connect to.</td><td>true</td><td>false</td><tr class="r0"><td><a id="AuthSource" name="AuthSource"></a><strong>AuthSource</strong></td><td>String</td><td>Specifies the authentication source type. The default authentication source type value is LocalUser. You can specify ActiveDirectory, OpenLDAP, or VC as authentication source type values.</td><td>false</td><td>false</td><tr class="r1"><td><a id="Credential" name="Credential"></a><strong>Credential</strong></td><td>PSCredential</td><td>Specifies a PSCredential object that contains credentials for authenticating with the server. For more information about the server authentication logic of PowerCLI, run &quot;help about_server_authentication&quot;.</td><td>true</td><td>true (ByValue)</td><tr class="r0"><td><a id="Force" name="Force"></a><strong>Force</strong></td><td>SwitchParameter</td><td>Suppresses all user interface prompts during the cmdlet execution.</td><td>false</td><td>false</td><tr class="r1"><td><a id="InformationAction" name="InformationAction"></a><strong>InformationAction</strong></td><td>ActionPreference</td><td></td><td>false</td><td>false</td><tr class="r0"><td><a id="InformationVariable" name="InformationVariable"></a><strong>InformationVariable</strong></td><td>String</td><td></td><td>false</td><td>false</td><tr class="r1"><td><a id="Menu" name="Menu"></a><strong>Menu</strong></td><td>SwitchParameter</td><td>Indicates that you want to select a connection server from a list of recently connected servers. If Menu is provided, the cmdlet retrieves a list of the last visited servers and enters a nested command prompt, so that you can select a server from the list.</td><td>true</td><td>false</td><tr class="r0"><td><a id="NotDefault" name="NotDefault"></a><strong>NotDefault</strong></td><td>SwitchParameter</td><td>Specifies that you do not want to save the specified servers as default servers.</td><td>false</td><td>false</td><tr class="r1"><td><a id="Password" name="Password"></a><strong>Password</strong></td><td>SecureString</td><td>Specifies the password you want to use for authenticating with the server. For more information about the server authentication logic of PowerCLI, run &quot;help about_server_authentication&quot;.
<br/>Note: If the password contains special characters, enclose the entire string in single quotes (&#39;).</td><td>false</td><td>false</td><tr class="r0"><td><a id="PipelineVariable" name="PipelineVariable"></a><strong>PipelineVariable</strong></td><td>String</td><td></td><td>false</td><td>false</td><tr class="r1"><td><a id="Port" name="Port"></a><strong>Port</strong></td><td>Int32</td><td>Specifies the port on the server you want to use for the connection. If not specified, the default port value is 443.</td><td>false</td><td>false</td><tr class="r0"><td><a id="SaveCredentials" name="SaveCredentials"></a><strong>SaveCredentials</strong></td><td>SwitchParameter</td><td>Indicates that you want to save the specified credentials in the local credential store.</td><td>false</td><td>false</td><tr class="r1"><td><a id="SessionSecret" name="SessionSecret"></a><strong>SessionSecret</strong></td><td>String</td><td>Specifies the ID of an existing vRealize Operations Manager session you want to reestablish.</td><td>true</td><td>false</td><tr class="r0"><td><a id="User" name="User"></a><strong>User</strong></td><td>String</td><td>Specifies the user name you want to use for authenticating with the server. For more information about the server authentication logic of PowerCLI, run &quot;help about_server_authentication&quot;.
<br/>Note: If the user name contains special characters, enclose the entire string in single quotes (&#39;).</td><td>false</td><td>false</td></table><p class="table-title">Return Type</p><a href="OMServer.html">OMServer</a>
<p class="table-title">Notes</p><p class="table-title">Examples</p><div class="example"><p class="example-title">--------------  Example 1 --------------</p><pre class="programlisting">Connect-OMServer -Server &#39;server_name&#39; -User &#39;user_name&#39; -Password &#39;user_password&#39;</pre><p>Connects to a vRealize Operations Manager server by using the User and Password parameters.</p><p class="example-title">--------------  Example 2 --------------</p><pre class="programlisting">Connect-OMServer -Server &#39;server_name&#39; ?AuthSource &#39;vCenterServer_name_in_vROps&#39; -User &#39;vCenterServer_admin&#39; -Password &#39;user_password&#39;</pre><p>Connects to a vRealize Operations Manager server as a vCenter Server user, imported from the monitored vCenter Server system.</p><p class="example-title">--------------  Example 3 --------------</p><pre class="programlisting">$srv = Connect-OMServer &#39;server_name&#39; -User &#39;admin&#39; -Password &#39;user_password&#39;
 
Connect-OMServer &#39;server_name&#39; -Session $srv.SessionId</pre><p>Connects to a vRealize Operations Manager server with an existing session.</p><p class="example-title">--------------  Example 4 --------------</p><pre class="programlisting">$secpasswd = ConvertTo-SecureString &#39;PlainTextPassword&#39; -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential (&#39;user_name&#39;, $secpasswd)

Connect-OMServer &#39;server_name&#39; -Credential $mycreds</pre><p>Connects to a vRealize Operations server by using a credentials object.</p></div><hr>Copyright &copy; VMware, Inc.&nbsp;All rights reserved.</body></html>
