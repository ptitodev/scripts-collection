<html><head><title>Copy-VMGuestFile - PowerCLI System.Collections.Hashtable.ModuleName Help Reference</title><meta name="description" content=" Copy-VMGuestFile" /><meta name="keywords" content="PowerCLI System.Collections.Hashtable.ModuleName Help Reference, Copy-VMGuestFile, Copy, VMGuestFile" /><link href="doc-style.css" type="text/css" rel="StyleSheet"></head><body><h2 class="title"><a class="title" href='index.html' target="_top">PowerCLI Reference</a></h2><h1>Copy-VMGuestFile</h1><h2>Synopsis</h2>This cmdlet copies files and folders from and to the guest OS of the specified virtual machines using VMware Tools.<p class="table-title">Syntax</p>Copy-VMGuestFile [-Source] &lt;String[]&gt; [-Destination] &lt;String&gt; -GuestToLocal [-Force] [-VM] &lt;VirtualMachine[]&gt; [-HostCredential &lt;PSCredential&gt;] [-HostUser &lt;String&gt;] [-HostPassword &lt;SecureString&gt;] [-GuestCredential &lt;PSCredential&gt;] [-GuestUser &lt;String&gt;] [-GuestPassword &lt;SecureString&gt;] [-ToolsWaitSecs &lt;Int32&gt;] [-Server &lt;VIServer[]&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]
<br/>
<br/>Copy-VMGuestFile [-Source] &lt;String[]&gt; [-Destination] &lt;String&gt; -LocalToGuest [-Force] [-VM] &lt;VirtualMachine[]&gt; [-HostCredential &lt;PSCredential&gt;] [-HostUser &lt;String&gt;] [-HostPassword &lt;SecureString&gt;] [-GuestCredential &lt;PSCredential&gt;] [-GuestUser &lt;String&gt;] [-GuestPassword &lt;SecureString&gt;] [-ToolsWaitSecs &lt;Int32&gt;] [-Server &lt;VIServer[]&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]<p class="table-title">Related Commands</p><a href='https://vdc-repo.vmware.com/vmwb-repository/dcr-public/7837e367-fe26-4d85-bd03-84d88261642c/2bc2f4e0-41f5-48b1-929e-e1568a8fe070/doc/Copy-VMGuestFile.html'>Online version</a><br><p class="table-title">Detailed Description</p>This cmdlet copies files and folders from and to the guest OS of the specified virtual machines using VMware Tools. Use the GuestUser and GuestPassword, or GuestCredential parameters to authenticate when connecting to the VMware Tools. To authenticate with the host, use the HostUser and HostPassword, or HostCredential parameters. SSPI is not supported. For a list of supported operating systems, see the PowerCLI User&#39;s Guide.
<br/>
<br/>To run this cmdlet against vCenter Server/ESX/ESXi versions earlier than 5.0, you need to meet the following requirements:
<br/>*You must run the cmdlet on the 32-bit version of Windows PowerShell.
<br/>*You must have access to the ESX that hosts the virtual machine over TCP port 902.
<br/>*For vCenter Server/ESX/ESXi versions earlier than 4.1, you need VirtualMachine.Interact.ConsoleInteract privilege. For vCenter Server/ESX/ESXi 4.1 and later, you need VirtualMachine.Interact.GuestControl privilege.
<br/>
<br/>To run this cmdlet against vCenter Server/ESXi 5.0 and later, you need VirtualMachine.GuestOperations.Modify privilege.<p class="table-title">Parameters</p><table cellspacing="0"><tr><th>Name</th><th>Type</th><th>Description</th><th>Required?</td><th>Pipeline Input</th><th>Default Value</th></tr><tr class="r1"><td><a id="Source" name="Source"></a><strong>Source</strong></td><td>String[]</td><td>Specifies the file you want to copy. If the file is on a virtual machine, specifies the absolute file path. Relative file paths are supported only when copying files from a local storage. Wildcards are allowed only at the end of the source path. If you are copying files from the guest operating system of a virtual machine to a local directory, the Source parameter supports wildcards only on vCenter Server 5.0 and later.</td><td>true</td><td>false</td><tr class="r0"><td><a id="Destination" name="Destination"></a><strong>Destination</strong></td><td>String</td><td>Specifies the destination path where you want to copy the file. If the destination points to a virtual machine, specify the absolute file path. Relative destination paths are supported only when copying files to a local storage.</td><td>true</td><td>false</td><tr class="r1"><td><a id="VM" name="VM"></a><strong>VM</strong></td><td><a href="VirtualMachine.html">VirtualMachine</a>[]</td><td>Specifies the virtual machine where the file is located.</td><td>true</td><td>true (ByValue)</td><tr class="r0"><td><a id="Confirm" name="Confirm"></a><strong>Confirm</strong></td><td>SwitchParameter</td><td>If the value is $true, indicates that the cmdlet asks for confirmation before running. If the value is $false, the cmdlet runs without asking for user confirmation.</td><td>false</td><td>false</td><tr class="r1"><td><a id="Force" name="Force"></a><strong>Force</strong></td><td>SwitchParameter</td><td>Indicates that the non-existing directories in the specified destination path are automatically created.</td><td>false</td><td>false</td><tr class="r0"><td><a id="GuestCredential" name="GuestCredential"></a><strong>GuestCredential</strong></td><td>PSCredential</td><td>Specifies a PSCredential object that contains credentials for authenticating with the guest OS where the file to be copied is located.</td><td>false</td><td>false</td><tr class="r1"><td><a id="GuestPassword" name="GuestPassword"></a><strong>GuestPassword</strong></td><td>SecureString</td><td>Specifies the password you want to use for authenticating with the guest OS where the file to be copied is located.</td><td>false</td><td>false</td><tr class="r0"><td><a id="GuestToLocal" name="GuestToLocal"></a><strong>GuestToLocal</strong></td><td>SwitchParameter</td><td>Indicates that you want to copy a file from the guest operating system of the virtual machine to a local directory.</td><td>true</td><td>false</td><tr class="r1"><td><a id="GuestUser" name="GuestUser"></a><strong>GuestUser</strong></td><td>String</td><td>Specifies the user name you want to use for authenticating with the guest OS where the file to be copied is located.</td><td>false</td><td>false</td><tr class="r0"><td><a id="HostCredential" name="HostCredential"></a><strong>HostCredential</strong></td><td>PSCredential</td><td>Specifies a PSCredential object that contains credentials for authenticating with the host where the file is to be copied. Do not use this parameter if the HostUser and HostPassword parameters are used. You need to specify host credentials only if the version of the vCenter Server or ESX you are authenticating with is earlier than 4.0, or the VIX version you have installed is earlier than 1.10.</td><td>false</td><td>false</td><tr class="r1"><td><a id="HostPassword" name="HostPassword"></a><strong>HostPassword</strong></td><td>SecureString</td><td>Specifies the password you want to use for authenticating with the host where the file is to be copied. You need to specify host credentials only if the version of the vCenter Server or ESX you are authenticating with is earlier than 4.0, or the VIX version you have installed is earlier than 1.10.</td><td>false</td><td>false</td><tr class="r0"><td><a id="HostUser" name="HostUser"></a><strong>HostUser</strong></td><td>String</td><td>Specifies the user name you want to use for authenticating with the host where the file is to be copied. You need to specify host credentials only if the version of the vCenter Server or ESX you are authenticating with is earlier than 4.0, or the VIX version you have installed is earlier than 1.10.</td><td>false</td><td>false</td><tr class="r1"><td><a id="LocalToGuest" name="LocalToGuest"></a><strong>LocalToGuest</strong></td><td>SwitchParameter</td><td>Indicates that you want to copy a file from a local directory to the guest operating system of the virtual machine.</td><td>true</td><td>false</td><tr class="r0"><td><a id="Server" name="Server"></a><strong>Server</strong></td><td><a href="VIServer.html">VIServer</a>[]</td><td>Specifies the vCenter Server systems on which you want to run the cmdlet. If no value is passed to this parameter, the command runs on the default servers. For more information about default servers, see the description of Connect-VIServer.</td><td>false</td><td>false</td><tr class="r1"><td><a id="ToolsWaitSecs" name="ToolsWaitSecs"></a><strong>ToolsWaitSecs</strong></td><td>Int32</td><td>Specifies the time in seconds to wait for a response from the VMware Tools. If a non-positive value is provided, the system waits infinitely long time.</td><td>false</td><td>false</td><tr class="r0"><td><a id="WhatIf" name="WhatIf"></a><strong>WhatIf</strong></td><td>SwitchParameter</td><td>Indicates that the cmdlet is run only to display the changes that would be made and actually no objects are modified.</td><td>false</td><td>false</td></table><p class="table-title">Return Type</p>None
<p class="table-title">Notes</p><p class="table-title">Examples</p><div class="example"><p class="example-title">--------------  Example 1 --------------</p><pre class="programlisting">Copy-VMGuestFile -Source c:\text.txt -Destination c:\temp\ -VM VM -GuestToLocal -GuestUser user -GuestPassword pass2</pre><p>Copies the text.txt file from the guest OS system to the local Temp directory.</p><p class="example-title">--------------  Example 2 --------------</p><pre class="programlisting">$vm = Get-VM -Name VM

Get-Item &quot;c:\FolderToCopy\*.*&quot; | Copy-VMGuestFile -Destination &quot;c:\MyFolder&quot; -VM $vm -LocalToGuest -GuestUser -GuestPassword pass2</pre><p>Copies files from a local machine to a guest operating system.</p></div><hr>Copyright &copy; VMware, Inc.&nbsp;All rights reserved.</body></html>
